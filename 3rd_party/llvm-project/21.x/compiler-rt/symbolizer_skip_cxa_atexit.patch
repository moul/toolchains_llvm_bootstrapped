diff --git a/lib/sanitizer_common/symbolizer/sanitizer_symbolize.cpp b/lib/sanitizer_common/symbolizer/sanitizer_symbolize.cpp
index 8d23834b2..d3c9e9b8d 100644
--- a/lib/sanitizer_common/symbolizer/sanitizer_symbolize.cpp
+++ b/lib/sanitizer_common/symbolizer/sanitizer_symbolize.cpp
@@ -166,7 +166,8 @@ bool __sanitizer_symbolize_set_inline_frames(bool Value) {
   InlineFrames = Value;
   return true;
 }
-
+#if !defined(SANITIZER_SKIP_CXA_ATEXIT_OVERRIDE)
 // Override __cxa_atexit and ignore callbacks.
 // This prevents crashes in a configuration when the symbolizer
 // is built into sanitizer runtime and consequently into the test process.
@@ -191,6 +192,7 @@ bool __sanitizer_symbolize_set_inline_frames(bool Value) {
 //
 // For the standalone llvm-symbolizer this does not hurt,
 // we just don't destroy few global objects on exit.
 int __cxa_atexit(void (*f)(void *a), void *arg, void *dso) { return 0; }
+#endif
 
 }  // extern "C"
